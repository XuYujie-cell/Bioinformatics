# 表达数据标准化的原因和必须性

对于从GEO数据库下载下来的表达数据可以直接使用吗？显然是不能的。因为本身这个数据矩阵是存在由各种因素引起的**误差**的。

误差来源：

- 个体差异：实验中可以通过增加生物重复。

- 批次效应：即不免的由不同时间点、不同操作者、不同试剂，和不同仪器而引起的批次不同。**这里来直观感受一下批次效应的存在，如果在PCA图上，control和exp组分别有3个样本，但是control和exp中各有一个点偏离同组内其他两个点较远，这就可能是因为测量这两个点时由特定原因而产生的批次效应。**可以使用R函数来减少批次效应。

  ```
  combat()
  ##来自sva包。
  
  removeBatchEffect（）
  ##来自limma包等。
  ```

  有必要确实是需要进行去批次效应的。

- **测序技术差异**：重点分析，数据需要标准化（广义上，包括均一化，归一化）。

- 异常极端值：即使已经通过标准化之后，依然存在明显不正常的值，应当予以剔除。



## Normalization

这里重点介绍一下标准化这一步骤，由于芯片和高通量测序的程序不同，因此常见的干扰因素和标准化方法是不同的。



### 对于芯片

常见的干扰因素：芯片杂交的RNA总量不一致，芯片表面不平整，探针非特异性结合，杂交条件不一致。

常用的方法：

- **Background** **correction**:移除非特异性结合等背景噪音，有助于检测出较低丰度下的倍数差异检出（MAS和RMA方法）。
- **Normalization**：消除测量间的非实验误差，使得不同芯片获得结果可以相互比较。
- **Summarization**：将前面得到的荧光强度值从探针水平汇总到探针组水平并对pm探针荧光值进行修正。这里的pm校正来源于芯片的测序原理，平台实际上会使用两种探针，一类是pm，即perfect match，即这类探针（芯片探针均为25 bp）能够完美匹配基因序列，而另一类为mm，即miss match,相较于pm少一bp，以用于检测非特异的杂信号，用于对pm的较正。

### 对于RNA-seq

在高通量测序过程中，样品间在数据总量，基因长度，基因数目，高表达基因分布，甚至同一个基因的不同转录本分布上存在差别。因此不能直接比较表达量，必须将数据进行归一化处理。



### 标准化计算（需要考虑到基因长度和测序深度）。

[RPKM、FPKM 和 TPM，解释清楚 - 知乎](https://zhuanlan.zhihu.com/p/425391789)

#### CPM（Counts Per Million）

把每个转录本/基因的原始计数除以样本总计数，再乘 106。这一计算过程中没有涉及到基因长度，因此**同一个样本内基因间不可直接比较**。只适用于把**同一个基因在多个样本**之间做粗略比较。

#### RPKM（Reads Per Kilobase Million）和FPKM（Fragments Per Kilobase Million）：

将原始 read 数除以基因长度（kb）， 再除以样本 read 总数（百万）。解决“长基因天然获得更多 read”问题，但**不同样本之间仍不可直接比较**（总量归一化顺序导致样本间总和不恒定）。

FPKM 与 RPKM 非常相似。RPKM 是为单端 RNA-seq 制作的，其中每个读数对应一个已测序的片段。FPKM 是为配对末端 RNA-seq 制作的。使用配对末端 RNA-seq，两个读数可以对应一个片段，或者，如果对中的一个读数没有映射，一个读数可以对应一个片段。RPKM 和 FPKM 之间的唯一区别是 FPKM 考虑到两个读取可以映射到一个片段（因此它不会将该片段计算两次）。

#### TPM（Transcripts Per Million）：

**先做长度校正，再做深度校正** —— 这样每个样本的 TPM 总和都正好是 106，消除了样本间总量差异，



edgeR / DESeq2 / limma‑voom 推荐直接用 raw counts（+ 库大小 / TMM / size‑factor 归一化），不用 RPKM/TPM 进模型。

若只能拿已发布的 TPM/RPKM 做 DE，可转回 pseudo‑counts 或用 sleuth/limma 的 voom‑transformed TPM，但统计功效会降低。

### 优化算法:

TMM(trimmed mean of M-values)-------edegR

RLE(relative log expression)-------DEseq

UQ(upper quartile)------limma

