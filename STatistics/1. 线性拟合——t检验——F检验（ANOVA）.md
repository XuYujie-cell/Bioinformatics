# 线性拟合——t检验——F检验（ANOVA）

## 线性拟合——t检验

假设在control和infection中，以control作为reference group，针对于infection组中的基因i表达：

**yi=对照组平均β0（固定值）+组间差β1⋅Infectedi（下拉表仅两个选项，转化为数值0/1）+年龄效应β2⋅Agei(下拉列表为0~100间的无数数值)+β3⋅group（下拉表三个选项，转化为数值2.4/10、225）+εi**

- Infectedi：在对应特定的基因i下，infection带来的差异效应量。取固定值1.
- 组间差β1：在H0假设下，β1=0，这里其实是可以对应起差异变化，effect size(t值)就是β1/标准误.



## 线性拟合——F检验

假设在low，medium，high中，以low作为reference group，针对于medium或high组中的基因i表达：

**yi=对照组平均β0（固定值）+组间差β1⋅Medium i（下拉表仅两个选项，转化为数值0/1）+组间差β2⋅High i（下拉表仅两个选项，转化为数值0/1）+年龄效应β3⋅Agei(下拉列表为0~100间的无数数值)+β4⋅group（下拉表三个选项，转化为数值2.4/10、225）+εi**

- 组间差β1和组间差β2：在H0假设下，β1=β2=0，effect size（F=组间变化/组内变化）需要考虑到每组的平均值.其实t值也是对应了两组的平均值比较。

## 协变量

上面两个线性拟合式中都出现了协变量，那么在一个式子中，协变量的加入和删除会造成什么影响呢？

协变量解释了与主效应无关的噪声（如批次、RIN、测序深度、年龄等），**降低残差方差** ⇒ SE 变小 ⇒ p 变小。因此加入协变量可以有助于提高对于差异基因的敏感度。

